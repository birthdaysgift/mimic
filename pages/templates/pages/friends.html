{% load static %}
<!--TODO: add mutual friends list-->
<div class="smooth-background">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="all-friends">
                    <div class="friends-header">
                        <h4 class="friends-header-text text-center">Friends</h4>
                    </div>
                    <div class="friends-list">
                        <!--TODO: max-height instead of height and vertical alignment-->
                        {% for friend in friends %}
                            <div class="friends-list-icon">
                                <!--This links are used in js-->
                                <a class="friend-link" href="{% url 'pages:page' friend.username %}"></a>
                                {% if friend.avatar %}
                                    <img src="{{ friend.avatar.url }}" class="contact-avatar">
                                {% else %}
                                    <img src="{% static 'pages/img/avatar_placeholder.png' %}" class="contact-avatar">
                                {% endif %}
                                <a href="{% url 'pages:page' friend.username %}">
                                    <b class="contact-username-text">{{ friend.username }}</b>
                                </a>
                                {% if friend in session_user_friends %}
                                    <img class="friends-icon" src="{% static 'pages/img/friends.png' %}">
                                {% endif %}
                                <a class="write-message-btn text-center" href="{% url 'talks:talk' friend.username 1 %}">Write a message</a>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(".all-friends").click(function (event) {
            event.stopPropagation();
        });
        $(".smooth-background").click(function (event) {
            $(".smooth-background").remove();
        });

        $(".friends-list-icon").click(function(event) {
            clicked = $(event.target);
            if (clicked.hasClass("contact-avatar")) {
                var linkURL = clicked.parent().find(".friend-link").attr("href");
                window.location.href = linkURL;
                return;
            };

            if (clicked.hasClass("friends-list-icon")) {
                var linkURL = clicked.find(".friend-link").attr("href");
                window.location.href = linkURL;
                return;
            };
        });

    </script>
</div>

<!--TODO: bg on whole screen-->